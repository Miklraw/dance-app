<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>High Heels Elite | Discipline Mode</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --primary: #D81B60; --primary-light: #FCE4EC; --accent: #C5A059;
            --danger: #ff4444; --text-main: #1A1A1A; --radius: 28px;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: #fff; color: var(--text-main); font-family: 'Lato', sans-serif; margin: 0; padding-bottom: 40px; transition: background 0.3s; }

        /* Splash */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #12050D; z-index: 10000; display: flex; justify-content: center; align-items: center; transition: opacity 0.8s; }
        .splash-logo { font-family: 'Playfair Display', serif; font-size: 32px; color: white; }

        header { padding: 20px; background: rgba(255,255,255,0.85); backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
        header h1 { margin: 0; font-family: 'Playfair Display', serif; font-size: 22px; color: var(--primary); }

        .page { display: none; padding: 20px; animation: slideUp 0.4s ease forwards; }
        .page.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Loyalty Card */
        #loyalty-card { padding: 22px; border-radius: var(--radius); color: white; margin-bottom: 20px; transition: all 0.5s; position: relative; overflow: hidden; }
        .status-gold { background: linear-gradient(135deg, #12050D 0%, #3a0a22 100%); box-shadow: 0 15px 30px rgba(216, 27, 96, 0.2); }
        .status-lost { background: linear-gradient(135deg, #555 0%, #222 100%); filter: grayscale(1); opacity: 0.8; }

        .progress-bar { background: rgba(255,255,255,0.1); height: 8px; border-radius: 10px; margin-top: 15px; }
        .progress-fill { background: linear-gradient(90deg, var(--primary), #FF4081); height: 100%; width: 50%; border-radius: 10px; transition: width 1s; }

        .stat-card { background: #fdf2f7; padding: 18px; border-radius: 22px; flex: 1; text-align: center; border: 1px solid var(--primary-light); }
        .stat-value { display: block; font-size: 24px; font-weight: 900; color: var(--primary); }
        .stat-minus { color: var(--danger) !important; animation: shake 0.5s; }

        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        .btn-action { background: var(--text-main); color: white; border: none; width: 100%; padding: 18px; border-radius: 50px; font-weight: 700; margin-top: 15px; }
        .daily-btn { background: var(--accent); color: white; border: none; padding: 15px; border-radius: 20px; width: 100%; font-weight: 700; margin-top: 20px; display: flex; align-items: center; justify-content: center; gap: 10px; }
    </style>
</head>
<body>
    <div id="splash-screen"><div class="splash-logo">High Heels Elite</div></div>
    
    <header>
        <h1 id="header-title">Studio</h1>
        <div id="mini-avatar" onclick="navigateTo('profile')" style="width:38px; height:38px; border-radius:50%; background-size:cover; background-color: var(--primary);"></div>
    </header>

    <div id="page-home" class="page active">
        <div id="loyalty-card" class="status-gold">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <span id="status-label" style="font-weight:700; letter-spacing:1px;">GOLD RESIDENT</span>
                <span id="xp-text" style="font-size:12px;">50 / 100 XP</span>
            </div>
            <div class="progress-bar"><div class="progress-fill" id="xp-fill"></div></div>
            <div id="discipline-msg" style="font-size: 10px; margin-top: 10px; opacity: 0.8;">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏–¥—É—Ç –ø–æ –≥—Ä–∞—Ñ–∏–∫—É ‚úì</div>
        </div>

        <div style="display:flex; gap:12px; margin-bottom:20px;">
            <div class="stat-card"><span class="stat-value" id="stats-bonus">150</span><span style="font-size:10px;">Diva-–∫–æ–∏–Ω–æ–≤</span></div>
            <div class="stat-card"><span class="stat-value" id="stats-streak">3 –¥–Ω—è</span><span style="font-size:10px;">–°—Ç—Ä–∏–∫</span></div>
        </div>

        <button class="daily-btn" onclick="checkIn()">
            <span>üî•</span> –û—Ç–º–µ—Ç–∏—Ç—å—Å—è –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ
        </button>

        <div style="margin-top:20px; color: var(--text-sec); font-size: 11px; text-align: center;">
            * –ü—Ä–æ–ø—É—Å–∫ –æ—Ç–º–µ—Ç–∫–∏ –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤ –≤–µ–¥–µ—Ç –∫ –ø–æ—Ç–µ—Ä–µ 50 –∫–æ–∏–Ω–æ–≤ –∏ XP.
        </div>
    </div>

    <div id="page-profile" class="page">
        <div style="text-align:center; margin-bottom:20px;">
            <div id="big-avatar" style="width:90px; height:90px; border-radius:50%; margin:0 auto 15px; background-size:cover; border:3px solid var(--accent);"></div>
            <h2 id="user-full-name">Diva</h2>
            <p id="profile-status-desc" style="color: var(--accent); font-weight: 700;">PRO LEVEL</p>
        </div>
        <button class="btn-action" style="background: var(--danger);" onclick="simulateMiss()">–ò–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫ (–¢–µ—Å—Ç)</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();
        const user = tg.initDataUnsafe.user || { first_name: "Diva" };

        let xp = 50;
        let bonus = 150;
        let streak = 3;
        let isLost = false;

        function initApp() {
            const photo = user.photo_url || `https://ui-avatars.com/api/?name=${user.first_name}&background=D81B60&color=fff`;
            document.getElementById('user-full-name').innerText = user.first_name;
            document.getElementById('mini-avatar').style.backgroundImage = `url(${photo})`;
            document.getElementById('big-avatar').style.backgroundImage = `url(${photo})`;
            
            setTimeout(() => { 
                document.getElementById('splash-screen').style.opacity='0'; 
                setTimeout(()=>document.getElementById('splash-screen').style.display='none',600); 
            }, 1500);
            updateUI();
        }

        function checkIn() {
            if(isLost) {
                isLost = false;
                xp = 50; bonus = 100; streak = 1;
                tg.showAlert("–°—Ç–∞—Ç—É—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! –ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –±–æ–ª—å—à–µ.");
            } else {
                xp = Math.min(xp + 10, 100);
                bonus += 20;
                streak++;
                confetti({ particleCount: 100, spread: 70 });
            }
            tg.HapticFeedback.notificationOccurred('success');
            updateUI();
        }

        function simulateMiss() {
            tg.HapticFeedback.notificationOccurred('error');
            document.body.style.background = "#ffebee";
            setTimeout(() => document.body.style.background = "#fff", 500);

            xp = Math.max(xp - 40, 0);
            bonus = Math.max(bonus - 50, 0);
            streak = 0;
            
            if(xp <= 20) isLost = true;
            
            updateUI();
            tg.showAlert("–í–ù–ò–ú–ê–ù–ò–ï: –í—ã –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –∑–∞–Ω—è—Ç–∏—è! –ë–∞–ª–ª—ã —Å–ø–∏—Å–∞–Ω—ã, —Å—Ç–∞—Ç—É—Å –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π.");
            navigateTo('home');
        }

        function updateUI() {
            const card = document.getElementById('loyalty-card');
            const fill = document.getElementById('xp-fill');
            const statusLabel = document.getElementById('status-label');
            const msg = document.getElementById('discipline-msg');

            fill.style.width = xp + "%";
            document.getElementById('xp-text').innerText = `${xp} / 100 XP`;
            document.getElementById('stats-bonus').innerText = bonus;
            document.getElementById('stats-streak').innerText = streak + " –¥–Ω.";

            if(isLost) {
                card.className = "status-lost";
                statusLabel.innerText = "STATUS: SUSPENDED";
                msg.innerText = "–°—Ä–æ—á–Ω–æ –æ—Ç–º–µ—Ç—å—Å—è, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏!";
                document.getElementById('profile-status-desc').innerText = "RESTRICTED ACCESS";
                document.getElementById('profile-status-desc').style.color = "red";
            } else {
                card.className = "status-gold";
                statusLabel.innerText = xp > 80 ? "PLATINUM DIVA" : "GOLD RESIDENT";
                msg.innerText = "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏–¥—É—Ç –ø–æ –≥—Ä–∞—Ñ–∏–∫—É ‚úì";
                document.getElementById('profile-status-desc').innerText = "PRO LEVEL";
                document.getElementById('profile-status-desc').style.color = "var(--accent)";
            }
        }

        function navigateTo(p) {
            document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active'));
            document.getElementById('page-' + p).classList.add('active');
            p === 'home' ? tg.BackButton.hide() : tg.BackButton.show();
        }

        tg.BackButton.onClick(() => navigateTo('home'));
        initApp();
    </script>
</body>
</html>
