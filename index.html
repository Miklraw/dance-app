<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>High Heels Elite | Luxe Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400;600;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { 
            --gold: #C5A059; 
            --gold-dark: #8e6d2f;
            --accent: #E91E63; 
            --dark: #080808; 
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(197, 160, 89, 0.2);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body { background: var(--dark); color: #F0F0F0; font-family: 'Montserrat', sans-serif; overflow-x: hidden; line-height: 1.6; }

        /* --- BACKGROUND SYSTEM --- */
        .background-wrapper { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: var(--dark); }
        #bg-video { width: 100%; height: 100%; object-fit: cover; opacity: 0.4; display: block; }
        .luxe-fallback { display: none; width: 100%; height: 100%; background: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #080808 100%); }
        .video-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, rgba(8,8,8,0.2) 0%, rgba(8,8,8,0.9) 100%); backdrop-filter: blur(2px); }

        /* --- UI COMPONENTS --- */
        header { padding: 30px 20px; text-align: center; border-bottom: 1px solid var(--border); backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 1000; }
        .logo-luxe { font-family: 'Playfair Display', serif; font-size: 22px; letter-spacing: 5px; text-transform: uppercase; color: var(--gold); }
        
        .container { padding: 20px; padding-bottom: 120px; max-width: 600px; margin: 0 auto; }
        .—Å—Ç—Ä–∞–Ω–∏—Ü–∞ { display: none; animation: fadeIn 0.6s ease; }
        .—Å—Ç—Ä–∞–Ω–∏—Ü–∞.–∞–∫—Ç–∏–≤–Ω–∞ { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- CARDS & BLOCKS --- */
        .luxe-card {
            background: rgba(20, 20, 20, 0.6); border: 1px solid var(--border); border-radius: 2px;
            padding: 40px 25px; position: relative; overflow: hidden; margin-bottom: 25px; text-align: center; backdrop-filter: blur(15px);
        }
        .luxe-card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(197, 160, 89, 0.1), transparent);
            animation: shine 5s infinite;
        }
        @keyframes shine { 100% { left: 200%; } }

        .rank-title { font-family: 'Playfair Display', serif; font-size: 32px; font-style: italic; color: var(--gold); margin: 10px 0; }
        .progress-line { height: 1px; background: rgba(197, 160, 89, 0.1); width: 100%; margin: 25px 0; position: relative; }
        .progress-fill { height: 1px; background: var(--gold); position: absolute; top: 0; left: 0; transition: 2s cubic-bezier(0.19, 1, 0.22, 1); box-shadow: 0 0 10px var(--gold); }

        .–±–ª–æ–∫ { background: var(--glass); border: 1px solid var(--border); padding: 20px; border-radius: 2px; margin-bottom: 15px; backdrop-filter: blur(10px); }

        /* --- BUTTONS --- */
        .luxe-btn {
            background: transparent; border: 1px solid var(--border); color: var(--gold);
            padding: 18px; font-size: 10px; text-transform: uppercase; letter-spacing: 2px;
            cursor: pointer; transition: 0.3s; width: 100%; margin-bottom: 12px; font-weight: 600;
        }
        .luxe-btn:active { background: var(--gold); color: black; }

        /* --- ADMIN & JOURNAL --- */
        .admin-only { display: none; }
        body.is-admin .admin-only { display: block; }
        .student-row { display: flex; align-items: center; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .present-btn { padding: 8px 15px; border-radius: 2px; border: 1px solid var(--gold); background: transparent; color: var(--gold); font-size: 9px; font-weight: 800; }
        .present-btn.on { background: var(--gold); color: black; }

        /* --- NAVIGATION --- */
        .tab-bar {
            position: fixed; bottom: 0; width: 100%; height: 85px; background: rgba(8,8,8,0.98);
            display: flex; justify-content: space-around; align-items: center; border-top: 1px solid var(--border);
            padding-bottom: env(safe-area-inset-bottom); z-index: 2000;
        }
        .tab-item { color: #444; font-size: 8px; text-transform: uppercase; letter-spacing: 1.5px; text-decoration: none; display: flex; flex-direction: column; align-items: center; flex: 1; transition: 0.3s; }
        .tab-item.active { color: var(--gold); }
        .tab-dot { width: 3px; height: 3px; background: var(--gold); border-radius: 50%; margin-top: 6px; opacity: 0; }
        .tab-item.active .tab-dot { opacity: 1; }
        
        .scan-circle { width: 50px; height: 50px; border: 1px solid var(--border); border-radius: 50%; display: flex; align-items: center; justify-content: center; transform: translateY(-5px); transition: 0.3s; }
        .scan-circle:active { border-color: var(--gold); scale: 0.9; }
    </style>
</head>
<body id="main-body">

    <div class="background-wrapper">
        <video autoplay muted loop playsinline id="bg-video" onerror="handleVideoError()">
            <source src="bg_video.mp4" type="video/mp4">
        </video>
        <div id="fallback-bg" class="luxe-fallback"></div>
        <div class="video-overlay"></div>
    </div>

    <header>
        <div class="logo-luxe">High Heels Elite</div>
    </header>

    <div class="container">
        
        <div id="home" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω–∞">
            <div class="luxe-card">
                <p style="font-size: 9px; letter-spacing: 3px; opacity: 0.6;">ESTABLISHED MEMBER</p>
                <div class="rank-title" id="status-name">Diva</div>
                <div class="progress-line"><div id="xp-fill" class="progress-fill"></div></div>
                <div style="display: flex; justify-content: space-between; font-size: 9px; color: var(--gold);">
                    <span id="xp-current">0 XP</span>
                    <span style="opacity: 0.5;">NEXT LEVEL</span>
                </div>
            </div>

            <div class="–±–ª–æ–∫" style="text-align: center;">
                <p id="streak-info" style="font-size: 10px; letter-spacing: 2px; color: var(--gold);">üî• 3 DAY STREAK</p>
            </div>

            <button class="luxe-btn" onclick="openBox()">Claim Daily Reward</button>
            <button class="luxe-btn" onclick="tg.openLink('https://platonovalena.zenclass.ru')">Online Academy</button>

            <div class="admin-only" style="margin-top: 30px;">
                <p style="font-size: 9px; color: var(--gold); text-align: center; margin-bottom: 15px; letter-spacing: 2px;">MANAGEMENT</p>
                <button class="luxe-btn" style="border-color: var(--accent); color: var(--accent);" onclick="coachReward(50)">Award +50 XP Group</button>
            </div>
        </div>

        <div id="journal" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            <h2 style="font-family: 'Playfair Display'; font-size: 24px; margin-bottom: 20px; color: var(--gold);">Attendance</h2>
            <div id="students-list"></div>
        </div>

        <div id="rating" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            <h2 style="font-family: 'Playfair Display'; font-size: 24px; margin-bottom: 20px; color: var(--gold);">Elite Ranking</h2>
            <div id="leaderboard"></div>
        </div>

        <div id="profile" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            <div style="text-align: center; padding: 20px;">
                <div id="big-ava" style="width: 100px; height: 100px; border: 1px solid var(--gold); margin: 0 auto 20px; background-size: cover;"></div>
                <h2 id="user-name" style="font-family: 'Playfair Display'; font-size: 28px;">Diva</h2>
                <p id="user-rank-label" style="font-size: 10px; letter-spacing: 3px; color: var(--gold); margin-top: 10px;"></p>
            </div>
        </div>

    </div>

    <nav class="tab-bar">
        <a href="javascript:void(0)" class="tab-item active" onclick="showPage('home', this)">Home<div class="tab-dot"></div></a>
        <a href="javascript:void(0)" class="tab-item" onclick="showPage('rating', this)">Elite<div class="tab-dot"></div></a>
        <div class="scan-circle" onclick="scanQR()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="1.2"><path d="M3 7V5a2 2 0 012-2h2m10 0h2a2 2 0 012 2v2m0 10v2a2 2 0 01-2 2h-2M7 21H5a2 2 0 01-2-2v-2"></path></svg>
        </div>
        <a href="javascript:void(0)" class="tab-item admin-only" onclick="showPage('journal', this)">CRM<div class="tab-dot"></div></a>
        <a href="javascript:void(0)" class="tab-item" onclick="showPage('profile', this)">Profile<div class="tab-dot"></div></a>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (–ó–∞–º–µ–Ω–∏ ID –Ω–∞ —Å–≤–æ–∏)
        const ADMIN_IDS = [123456789, 7461427508]; 
        const STATUSES = ["Novice", "Student", "Grace", "Aesthetic", "Muse", "Ambassador", "Star", "Premium Diva", "Platinum Diva", "Icon"];
        
        let state = {
            xp: parseInt(localStorage.getItem('hhe_xp')) || 0,
            name: tg.initDataUnsafe.user?.first_name || "Diva",
            id: tg.initDataUnsafe.user?.id
        };

        const MOCK_STUDENTS = [
            {id: 1, name: "–ú–∞—Ä–∏—è", xp: 850, present: false},
            {id: 2, name: "–ê–Ω–Ω–∞", xp: 1200, present: true},
            {id: 3, name: "–ï–ª–∏–∑–∞–≤–µ—Ç–∞", xp: 450, present: false}
        ];

        function handleVideoError() {
            document.getElementById('bg-video').style.display = 'none';
            document.getElementById('fallback-bg').style.display = 'block';
        }

        function render() {
            const idx = Math.min(Math.floor(state.xp / 100), 9);
            const curXP = state.xp % 100;

            document.getElementById('status-name').innerText = STATUSES[idx];
            document.getElementById('xp-fill').style.width = curXP + '%';
            document.getElementById('xp-current').innerText = curXP + ' XP';
            
            document.getElementById('user-name').innerText = state.name;
            document.getElementById('user-rank-label').innerText = STATUSES[idx].toUpperCase();
            const img = `https://ui-avatars.com/api/?name=${state.name}&background=080808&color=C5A059&size=200`;
            document.getElementById('big-ava').style.backgroundImage = `url(${img})`;

            if(ADMIN_IDS.includes(state.id)) document.body.classList.add('is-admin');
            
            updateLeaderboard();
            renderJournal();
        }

        function renderJournal() {
            const list = document.getElementById('students-list');
            list.innerHTML = MOCK_STUDENTS.map(s => `
                <div class="student-row">
                    <div><span style="font-size:14px; font-weight:600;">${s.name}</span><br><small style="color:var(--gold); font-size:9px;">${s.xp} XP</small></div>
                    <button class="present-btn ${s.present?'on':''}" onclick="toggleStudent(${s.id})">${s.present?'PRESENT':'ABSENT'}</button>
                </div>
            `).join('');
        }

        function toggleStudent(id) {
            const s = MOCK_STUDENTS.find(x => x.id === id);
            s.present = !s.present;
            tg.HapticFeedback.impactOccurred('light');
            renderJournal();
        }

        function coachReward(p) {
            state.xp += p;
            localStorage.setItem('hhe_xp', state.xp);
            confetti({ particleCount: 60, spread: 70, colors: ['#C5A059'], origin: { y: 0.8 } });
            tg.HapticFeedback.notificationOccurred('success');
            render();
        }

        function openBox() {
            if(localStorage.getItem('hhe_box_claimed') == new Date().getDate()) {
                tg.showAlert("Elite Box will be available tomorrow. ‚ú®");
                return;
            }
            localStorage.setItem('hhe_box_claimed', new Date().getDate());
            tg.HapticFeedback.impactOccurred('medium');
            tg.showAlert("Luxe Gift: +25 XP added to your status.");
            coachReward(25);
        }

        function showPage(pageId, el) {
            document.querySelectorAll('.—Å—Ç—Ä–∞–Ω–∏—Ü–∞').forEach(p => p.classList.remove('–∞–∫—Ç–∏–≤–Ω–∞'));
            document.getElementById(pageId).classList.add('–∞–∫—Ç–∏–≤–Ω–∞');
            document.querySelectorAll('.tab-item').forEach(i => i.classList.remove('active'));
            if(el) el.classList.add('active');
            tg.HapticFeedback.selectionChanged();
        }

        function scanQR() {
            tg.showScanQrPopup({ text: "Scan Member Pass" }, (text) => {
                if(text.includes("HHE_XP")) {
                    coachReward(30);
                    tg.closeScanQrPopup();
                }
            });
        }

        function updateLeaderboard() {
            const list = document.getElementById('leaderboard');
            const leaders = [{n: "Elena P. ‚ú®", x: 5000}, {n: state.name, x: state.xp, me: true}, {n: "Mariya", x: 920}].sort((a,b) => b.x - a.x);
            list.innerHTML = leaders.map((u, i) => `
                <div class="–±–ª–æ–∫" style="display:flex; justify-content:space-between; align-items:center; ${u.me?'border-color:var(--gold)':''}">
                    <span style="font-size:12px;">#${i+1} ${u.n}</span>
                    <span style="color:var(--gold); font-weight:800; font-size:12px;">${u.x} XP</span>
                </div>
            `).join('');
        }

        render();
    </script>
</body>
</html>
