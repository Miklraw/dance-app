<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>High Heels Elite</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --primary: #D81B60; --primary-light: #FCE4EC; --accent: #C5A059;
            --text-main: #1A1A1A; --text-sec: #757575; --radius: 24px;
        }

        body {
            background: #FFFFFF; color: var(--text-main); font-family: 'Lato', sans-serif;
            margin: 0; padding-bottom: 40px; overflow-x: hidden;
        }

        /* --- –ó–ê–°–¢–ê–í–ö–ê (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω z-index) --- */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #12050D; z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.6s ease-out;
        }
        .splash-logo { font-family: 'Playfair Display', serif; font-size: 32px; color: white; }

        header {
            padding: 20px; background: rgba(255,255,255,0.8); backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
        }
        header h1 { margin: 0; font-family: 'Playfair Display', serif; font-size: 22px; color: var(--primary); }

        .page { display: none; padding: 20px; animation: slideUp 0.4s ease-out forwards; }
        .page.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* BENTO */
        .bento-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; }
        .bento-item { 
            background: #fff; border-radius: var(--radius); padding: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.03);
        }
        .bento-wide { grid-column: span 2; }
        .bento-accent { background: var(--primary); color: white; }
        .bento-gold { background: var(--accent); color: white; }

        /* –ö–ê–†–¢–û–ß–ö–ò */
        .course-card { background: white; border-radius: var(--radius); overflow: hidden; margin-bottom: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .course-img { width: 100%; height: 200px; object-fit: cover; }
        .btn-action { 
            background: var(--text-main); color: white; border: none; width: 100%;
            padding: 16px; border-radius: 50px; font-weight: 700; cursor: pointer;
        }

        .legal-box { font-size: 11px; color: var(--text-sec); background: #f9f9f9; padding: 15px; border-radius: 15px; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="splash-screen"><div class="splash-logo">High Heels Elite</div></div>

    <header>
        <h1 id="header-title">Studio</h1>
        <div id="mini-avatar" onclick="navigateTo('profile')" style="width:35px; height:35px; border-radius:50%; background-size:cover; background-color: var(--primary);"></div>
    </header>

    <div id="page-home" class="page active">
        <div class="bento-grid">
            <div class="bento-item bento-wide" onclick="navigateTo('profile')">
                <div id="welcome-name" style="font-family:'Playfair Display'; font-size:20px;">–ü—Ä–∏–≤–µ—Ç, Diva</div>
                <div style="font-size: 12px; opacity: 0.7;">–°—Ç–∞—Ç—É—Å: Resident Diva</div>
            </div>
            <div class="bento-item bento-accent" onclick="navigateTo('online')">
                <div style="font-size: 24px;">üì∫</div>
                <div style="font-weight:700;">–û–Ω–ª–∞–π–Ω</div>
            </div>
            <div class="bento-item bento-gold" onclick="navigateTo('offline')">
                <div style="font-size: 24px;">üë†</div>
                <div style="font-weight:700;">–í –∑–∞–ª–µ</div>
            </div>
        </div>
        
        <div style="margin-top: 30px; padding: 15px; background: var(--primary-light); border-radius: var(--radius); display: flex; align-items: center; gap: 12px;">
            <input type="checkbox" id="legal-check" style="width:20px; height:20px;">
            <label for="legal-check" style="font-size: 11px;">–Ø —Å–æ–≥–ª–∞—Å–Ω–∞ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ–¥. –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏–π.</label>
        </div>
    </div>

    <div id="page-catalog" class="page">
        <div id="catalog-container"></div>
    </div>

    <div id="page-profile" class="page">
        <div style="text-align: center;">
            <div id="big-avatar" style="width:100px; height:100px; border-radius:50%; margin: 0 auto 15px; background-size:cover; border: 3px solid var(--accent);"></div>
            <h2 id="user-full-name" style="font-family:'Playfair Display'; margin:0;">Diva</h2>
        </div>
        <div class="legal-box">
            <b>Disclaimer:</b> –£—á—Ä–µ–¥–∏—Ç–µ–ª—å –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–µ—Ç–∏ –∑–¥–∞–Ω–∏–π –∏ —Ç—Ä–∞–≤–º—ã –ø—Ä–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏.
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const user = tg.initDataUnsafe.user || { first_name: "Diva", id: 0 };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function initApp() {
            const photo = user.photo_url || `https://ui-avatars.com/api/?name=${user.first_name}&background=D81B60&color=fff`;
            document.getElementById('welcome-name').innerText = `–ü—Ä–∏–≤–µ—Ç, ${user.first_name}`;
            document.getElementById('user-full-name').innerText = `${user.first_name} ${user.last_name || ''}`;
            document.getElementById('mini-avatar').style.backgroundImage = `url(${photo})`;
            document.getElementById('big-avatar').style.backgroundImage = `url(${photo})`;
            
            // –£–±–∏—Ä–∞–µ–º –∑–∞—Å—Ç–∞–≤–∫—É
            setTimeout(() => {
                const splash = document.getElementById('splash-screen');
                splash.style.opacity = '0';
                setTimeout(() => splash.style.display = 'none', 600);
            }, 2000);
        }

        function navigateTo(pageId) {
            tg.HapticFeedback.impactOccurred('light');
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            if (pageId === 'home') {
                document.getElementById('page-home').classList.add('active');
                document.getElementById('header-title').innerText = 'Studio';
                tg.BackButton.hide();
            } else if (pageId === 'profile') {
                document.getElementById('page-profile').classList.add('active');
                document.getElementById('header-title').innerText = '–ü—Ä–æ—Ñ–∏–ª—å';
                tg.BackButton.show();
            } else {
                document.getElementById('page-catalog').classList.add('active');
                document.getElementById('header-title').innerText = (pageId === 'online' ? '–û–Ω–ª–∞–π–Ω' : '–í –∑–∞–ª–µ');
                tg.BackButton.show();
                renderCatalog(pageId);
            }
        }

        tg.BackButton.onClick(() => navigateTo('home'));

        const mockData = {
            online: [{ id: 'on1', title: '–ë–∞–∑–∞: –°–µ–∫—Å—É–∞–ª—å–Ω—ã–π —à–∞–≥', price: '1900 ‚ÇΩ', img: 'https://images.unsplash.com/photo-1547153760-18fc86324498?w=600' }],
            offline: [{ id: 'off1', title: '–ó–∞–Ω—è—Ç–∏–µ –≤ —Å—Ç—É–¥–∏–∏', price: '1000 ‚ÇΩ', img: 'https://images.unsplash.com/photo-1544367563-12123d8965cd?w=600' }]
        };

        function renderCatalog(type) {
            const container = document.getElementById('catalog-container');
            container.innerHTML = '';
            mockData[type].forEach(item => {
                const card = document.createElement('div');
                card.className = 'course-card';
                card.innerHTML = `
                    <img src="${item.img}" class="course-img">
                    <div style="padding:20px;">
                        <div style="font-family:'Playfair Display'; font-size:20px; margin-bottom:5px;">${item.title}</div>
                        <div style="color:var(--primary); font-weight:700; font-size:18px;">${item.price}</div>
                        <button class="btn-action" onclick="purchase('${item.id}', '${item.title}', '${item.price}')">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
                    </div>`;
                container.appendChild(card);
            });
        }

        function purchase(id, title, price) {
            if (!document.getElementById('legal-check').checked) {
                tg.showAlert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏ —Å–æ–≥–ª–∞—Å–∏–µ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.");
                return;
            }

            tg.showPopup({
                title: '–ó–∞–ø–∏—Å—å',
                message: `–û—Ñ–æ—Ä–º–∏—Ç—å "${title}" –∑–∞ ${price}?`,
                buttons: [{id: "buy", type: "default", text: "–î–∞"}, {type: "cancel", text: "–û—Ç–º–µ–Ω–∞"}]
            }, (btn) => {
                if (btn === 'buy') {
                    confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                    tg.HapticFeedback.notificationOccurred('success');
                    
                    // –û—Ç–ø—Ä–∞–≤–∫–∞ –±–æ—Ç—É
                    const data = { action: 'purchase', id: id, title: title, user_id: user.id };
                    setTimeout(() => tg.sendData(JSON.stringify(data)), 1200);
                }
            });
        }

        initApp();
    </script>
</body>
</html>