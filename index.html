<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–í –î–í–ò–ñ–ï–ù–ò–ò</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #C5A059; --dark: #080808; --border: rgba(197, 160, 89, 0.3); --glass: rgba(255, 255, 255, 0.06); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
        body { background: var(--dark); color: #F0F0F0; font-family: 'Montserrat', sans-serif; overflow: hidden; }

        /* –§–æ–Ω */
        .background-wrapper { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        #bg-video { width: 100%; height: 100%; object-fit: cover; opacity: 0.35; }
        .video-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, transparent 0%, var(--dark) 95%); backdrop-filter: blur(1px); }

        /* –®–∞–ø–∫–∞ */
        header { padding: 30px 20px; text-align: center; border-bottom: 1px solid var(--border); backdrop-filter: blur(10px); z-index: 100; position: relative; }
        .logo-luxe { font-family: 'Playfair Display', serif; font-size: 20px; letter-spacing: 7px; text-transform: uppercase; color: var(--gold); }
        .page-subtitle { font-size: 9px; letter-spacing: 4px; text-transform: uppercase; color: #fff; margin-top: 10px; opacity: 0.7; display: none; }

        .container { padding: 25px; padding-bottom: 140px; height: calc(100vh - 100px); overflow-y: auto; }
        .—Å—Ç—Ä–∞–Ω–∏—Ü–∞ { display: none; animation: fadeIn 0.4s ease forwards; }
        .—Å—Ç—Ä–∞–Ω–∏—Ü–∞.–∞–∫—Ç–∏–≤–Ω–∞ { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* –°—Ç–∏–ª–∏ –ú–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª–∞ –î–≤–∏–≥–∞—Ç—å—Å—è */
        .move-manifesto { text-align: center; padding: 20px 0 40px; }
        .manifesto-text { font-family: 'Playfair Display', serif; font-style: italic; font-size: 24px; line-height: 1.5; color: #fff; margin-bottom: 10px; }
        
        /* –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ */
        .intro-box { text-align: center; padding: 60px 10px; }
        .intro-title { font-family: 'Playfair Display', serif; font-size: 18px; color: var(--gold); letter-spacing: 2px; margin-bottom: 20px; text-transform: uppercase; }
        .promo-desc { font-size: 13px; line-height: 1.8; color: #ccc; letter-spacing: 1px; max-width: 280px; margin: 0 auto; font-weight: 200; }

        /* –ö–Ω–æ–ø–∫–∏ */
        .luxe-btn { 
            background: var(--glass); border: 1px solid var(--border); color: var(--gold); 
            padding: 22px; font-size: 11px; text-transform: uppercase; letter-spacing: 3px; 
            cursor: pointer; width: 100%; margin-bottom: 15px; backdrop-filter: blur(10px); 
        }
        .luxe-btn:active { background: var(--gold); color: black; }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .avatar-upload { width: 100px; height: 100px; border: 1px solid var(--gold); margin: 0 auto 20px; background-size: cover; background-position: center; border-radius: 2px; }
        .streak-info { font-size: 10px; color: var(--gold); letter-spacing: 2px; margin-bottom: 15px; text-transform: uppercase; display: block; }
        .luxe-card { background: var(--glass); border: 1px solid var(--border); padding: 30px 20px; text-align: center; margin-bottom: 20px; position: relative; }
        .rank-title { font-family: 'Playfair Display', serif; font-size: 28px; font-style: italic; color: var(--gold); margin: 5px 0; }
        .progress-line { height: 1px; background: rgba(197, 160, 89, 0.1); width: 100%; margin: 20px 0; position: relative; }
        .progress-fill { height: 1px; background: var(--gold); position: absolute; left: 0; transition: 2s; box-shadow: 0 0 8px var(--gold); }

        /* –¢–∞–±–±–∞—Ä –æ—Å—Ç—Ä–æ–≤–∫–æ–º */
        .tab-bar { 
            position: fixed; bottom: 20px; left: 20px; right: 20px; height: 70px; 
            background: rgba(10, 10, 10, 0.95); display: flex; align-items: center; 
            justify-content: space-around; border: 1px solid var(--border); border-radius: 25px; 
            z-index: 1000; backdrop-filter: blur(20px);
        }
        .tab-item { 
            color: #666; font-size: 9px; text-transform: uppercase; letter-spacing: 1px; 
            text-decoration: none; display: flex; flex-direction: column; align-items: center; 
            flex: 1; transition: 0.3s; height: 100%; justify-content: center;
        }
        .tab-item.active { color: var(--gold); }
        .tab-item svg { margin-bottom: 4px; stroke: currentColor; transition: 0.3s; }
        .tab-dot { width: 4px; height: 4px; background: var(--gold); border-radius: 50%; margin-top: 4px; opacity: 0; }
        .tab-item.active .tab-dot { opacity: 1; box-shadow: 0 0 8px var(--gold); }

        .leader-item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid var(--glass); font-size: 11px; }
    </style>
</head>
<body>

    <div class="background-wrapper">
        <video autoplay muted loop playsinline id="bg-video"><source src="bg_video.mp4" type="video/mp4"></video>
        <div class="video-overlay"></div>
    </div>

    <header>
        <div class="logo-luxe">–í –î–í–ò–ñ–ï–ù–ò–ò</div>
        <div id="header-subtitle" class="page-subtitle">–ü—Ä–æ—Ñ–∏–ª—å</div>
    </header>

    <div class="container">
        <div id="page-home" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω–∞">
            <div class="intro-box">
                <div class="intro-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</div>
                <p class="promo-desc">
                    –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç —ç—Å—Ç–µ—Ç–∏–∫—É –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å. –¢–≤–æ–π –ø—É—Ç—å –∫ –∏–¥–µ–∞–ª—å–Ω–æ–π –≥—Ä–∞—Ü–∏–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–¥–µ—Å—å.
                </p>
            </div>
        </div>

        <div id="page-move-choice" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            <div class="move-manifesto">
                <p class="manifesto-text">–î–≤–∏–≥–∞—Ç—å—Å—è.<br>–ß—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å.<br>–°–¥–µ–ª–∞—Ç—å —Å–µ–±—è —Å–∞–º–æ–π.</p>
                <div style="width: 30px; height: 1px; background: var(--gold); margin: 0 auto; opacity: 0.5;"></div>
            </div>
            
            <div style="padding-top: 10px;">
                <button class="luxe-btn" onclick="btnClick('page-offline-menu')">–û–§–§–õ–ê–ô–ù (–í –°–¢–£–î–ò–ò)</button>
                <button class="luxe-btn" onclick="triggerHaptic(); tg.openLink('https://platonovalena.zenclass.ru')">–û–ù–õ–ê–ô–ù (–ê–ö–ê–î–ï–ú–ò–Ø)</button>
            </div>
        </div>

        <div id="page-offline-menu" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            <button class="luxe-btn" onclick="triggerHaptic()">–ö—É—Ä—Å—ã</button>
            <button class="luxe-btn" onclick="triggerHaptic()">–ú–∞—Å—Ç–µ—Ä –∫–ª–∞—Å—Å—ã</button>
            <button class="luxe-btn" onclick="triggerHaptic()">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</button>
            <button class="luxe-btn" onclick="triggerHaptic(); tg.openLink('https://t.me/platonovalena')">–¢–µ—Ö.–ø–æ–¥–¥–µ—Ä–∂–∫–∞</button>
            <button class="luxe-btn" style="border:none; opacity:0.5; margin-top:10px;" onclick="btnClick('page-move-choice')">‚Üê –ù–∞–∑–∞–¥</button>
        </div>

        <div id="page-profile" class="—Å—Ç—Ä–∞–Ω–∏—Ü–∞">
            <input type="file" id="ava-input" hidden accept="image/*" onchange="uploadPhoto(this)">
            <div id="user-ava" class="avatar-upload" onclick="document.getElementById('ava-input').click()"></div>
            
            <div class="luxe-card">
                <span class="streak-info">üî• 3 –¥–Ω—è –≤ –¥–≤–∏–∂–µ–Ω–∏–∏</span>
                <p style="font-size: 7px; letter-spacing: 2px; opacity: 0.5; text-transform: uppercase;">–°—Ç–∞—Ç—É—Å</p>
                <div class="rank-title" id="status-name">–î–∏–≤–∞</div>
                <div class="progress-line"><div id="xp-fill" class="progress-fill"></div></div>
                <div style="display: flex; justify-content: space-between; font-size: 9px; color: var(--gold);">
                    <span id="xp-current">0 XP</span>
                    <span>ELITE TOP</span>
                </div>
            </div>

            <button class="luxe-btn" style="border-color: var(--gold);" onclick="scanQR()">–°–ö–ê–ù–ò–†–û–í–ê–¢–¨ QR-–ö–û–î</button>
            <button class="luxe-btn" onclick="openBox()">–ü–û–õ–£–ß–ò–¢–¨ –ö–û–ú–ü–õ–ò–ú–ï–ù–¢ –î–ù–Ø</button>

            <div style="font-family: 'Playfair Display'; font-size: 18px; color: var(--gold); text-align: center; margin-top: 35px; font-style: italic;">Elite Top</div>
            <div id="leaderboard" class="luxe-card" style="padding: 10px; text-align: left; margin-top: 15px;"></div>
        </div>
    </div>

    <nav class="tab-bar">
        <a href="javascript:void(0)" class="tab-item" onclick="showPage('page-move-choice', this)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="1.5"><path d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg>
            –î–≤–∏–≥–∞—Ç—å—Å—è
            <div class="tab-dot"></div>
        </a>
        <a href="javascript:void(0)" class="tab-item active" onclick="showPage('page-home', this)">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="1.5"><path d="M3 12l9-9 9 9M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
            –ì–ª–∞–≤–Ω–∞—è
        </a>
        <a href="javascript:void(0)" class="tab-item" onclick="showPage('page-profile', this)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="1.5"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
            <span id="nav-user-name">–ü—Ä–æ—Ñ–∏–ª—å</span>
            <div class="tab-dot"></div>
        </a>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        const bellSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3');
        bellSound.volume = 0.4;

        function triggerHaptic() { tg.HapticFeedback.impactOccurred('medium'); }
        function triggerSuccessHaptic() { tg.HapticFeedback.notificationOccurred('success'); }
        function playSuccessSound() { bellSound.currentTime = 0; bellSound.play().catch(()=>{}); }

        const –°–¢–ê–¢–£–°–´ = ["–ù–∞—á–∞–ª–æ", "–£—á–µ–Ω–∏—Ü–∞", "–ì—Ä–∞—Ü–∏—è", "–≠—Å—Ç–µ—Ç–∏–∫–∞", "–ú—É–∑–∞", "–ê–º–±–∞—Å—Å–∞–¥–æ—Ä", "–ó–≤–µ–∑–¥–∞", "–ü—Ä–µ–º–∏—É–º –î–∏–≤–∞", "–ü–ª–∞—Ç–∏–Ω–æ–≤–∞—è –î–∏–≤–∞", "–ò–∫–æ–Ω–∞"];
        let state = { xp: parseInt(localStorage.getItem('move_xp')) || 0, name: tg.initDataUnsafe.user?.first_name || "–î–∏–≤–∞", photo: localStorage.getItem('move_photo') || '' };

        function render() {
            const idx = Math.min(Math.floor(state.xp / 100), 9);
            document.getElementById('status-name').innerText = –°–¢–ê–¢–£–°–´[idx];
            document.getElementById('xp-fill').style.width = (state.xp % 100) + '%';
            document.getElementById('xp-current').innerText = (state.xp % 100) + ' XP';
            document.getElementById('nav-user-name').innerText = state.name;
            const ava = document.getElementById('user-ava');
            ava.style.backgroundImage = state.photo ? `url(${state.photo})` : `url('https://ui-avatars.com/api/?name=${state.name}&background=080808&color=C5A059')`;
            
            const leaders = [{n: "–ê–ª–µ–Ω–∞ –ü.", x: 5000}, {n: state.name, x: state.xp, me: true}, {n: "–ú–∞—Ä–∏—è", x: 420}].sort((a,b) => b.x - a.x);
            document.getElementById('leaderboard').innerHTML = leaders.map((u, i) => `
                <div class="leader-item" style="${u.me ? 'color: var(--gold); font-weight: bold;' : ''}">
                    <span>${i+1}. ${u.n}</span><span>${u.x} XP</span>
                </div>`).join('');
        }

        function showPage(pageId, el) {
            document.querySelectorAll('.—Å—Ç—Ä–∞–Ω–∏—Ü–∞').forEach(p => p.classList.remove('–∞–∫—Ç–∏–≤–Ω–∞'));
            document.getElementById(pageId).classList.add('–∞–∫—Ç–∏–≤–Ω–∞');
            
            const subtitle = document.getElementById('header-subtitle');
            if (pageId === 'page-profile') {
                subtitle.style.display = 'block'; subtitle.innerText = '–ü—Ä–æ—Ñ–∏–ª—å';
            } else {
                subtitle.style.display = 'none';
            }

            if(el) { 
                document.querySelectorAll('.tab-item').forEach(i => i.classList.remove('active')); 
                el.classList.add('active'); 
            }
            tg.HapticFeedback.selectionChanged();
        }

        function btnClick(pageId) { triggerHaptic(); showPage(pageId); }

        function openBox() {
            triggerHaptic();
            if(localStorage.getItem('move_claimed') == new Date().getDate()) { tg.showAlert("–ñ–¥–µ–º —Ç–µ–±—è –∑–∞–≤—Ç—Ä–∞! ‚ú®"); return; }
            localStorage.setItem('move_claimed', new Date().getDate());
            state.xp += 25; localStorage.setItem('move_xp', state.xp); 
            render(); playSuccessSound(); triggerSuccessHaptic();
            confetti({ particleCount: 70, colors: ['#C5A059'], origin: { y: 0.8 } });
        }

        function scanQR() {
            triggerHaptic();
            tg.showScanQrPopup({ text: "–°—Ç—É–¥–∏—è: –ß–µ–∫–∏–Ω" }, (text) => {
                if(text.includes("MOVE")) { 
                    state.xp += 30; localStorage.setItem('move_xp', state.xp); 
                    render(); playSuccessSound(); triggerSuccessHaptic();
                    tg.closeScanQrPopup(); 
                }
            });
        }

        function uploadPhoto(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => { state.photo = e.target.result; localStorage.setItem('move_photo', state.photo); render(); };
                reader.readAsDataURL(input.files[0]);
            }
        }
        render();
    </script>
</body>
</html>
